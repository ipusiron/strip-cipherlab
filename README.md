<!--
---
title: Strip CipherLab
category: classical-cryptography
difficulty: 1
description: Interactive web tool to grasp the strip cipher’s structure: generate strips, set selection/placement, then encrypt and decrypt step-by-step.
tags: [strip-cipher, classical-crypto, education, visualization, javascript]
demo: https://ipusiron.github.io/strip-cipherlab/
---
-->

# Strip CipherLab - ストリップ暗号ツール

![GitHub Repo stars](https://img.shields.io/github/stars/ipusiron/strip-cipherlab?style=social)
![GitHub forks](https://img.shields.io/github/forks/ipusiron/strip-cipherlab?style=social)
![GitHub last commit](https://img.shields.io/github/last-commit/ipusiron/strip-cipherlab)
![GitHub license](https://img.shields.io/github/license/ipusiron/strip-cipherlab)
[![GitHub Pages](https://img.shields.io/badge/demo-GitHub%20Pages-blue?logo=github)](https://ipusiron.github.io/strip-cipherlab/)

**Day071 - 生成AIで作るセキュリティツール100**


**Strip CipherLab**は、ストリップ暗号の**構造と考え方**を直感的に理解できるWebツールです。

ストリップ生成、ストリップ初期設定（選択・配置）、暗号化、復号という一連の手順を通じて、ストリップ暗号の**構造と考え方**を直感的に理解できます。

---

## 🌐 デモページ

👉 **[https://ipusiron.github.io/strip-cipherlab/](https://ipusiron.github.io/strip-cipherlab/)**

ブラウザーで直接お試しいただけます。

---

## 📸 スクリーンショット

>![平文"monitorlog"を暗号化する](assets/screenshot.png)  
>*平文"monitorlog"を暗号化する*

---

## 🔐 ストリップ暗号

**ストリップ暗号（strip cipher）**は、ランダム順のアルファベット列を印字した細長い**ストリップ**（帯）を多数用意し、フレーム上に並べて**列位置を共有**しながら、平文行とは**別の行**を暗号文として読み出す換字式暗号です。

### 暗号化の仕組み

**前提**
- ストリップは通常 **20〜50本**（場合によりそれ以上）。
- 鍵語で **装着順** を決める（本件は「アルファベット順割当（同字は左から若番）」の **一例** を採用）。  
  例：`"The strip cipher"` → `THESTRIPCIPHER` →  
  装着順：`17 5 2 15 17 12 8 10 1 9 11 6 3 13 19 7 4 16 20 14`
- 1本のストリップの配列は **26!** 通り。  
  n本からr本を **順序つき** で選ぶ総数は **nPr = n!/(n−r)!**。

1. **周期 r**（使用ストリップ本数）に合わせ、**平文を r文字単位の群（ブロック）** に分ける。  
   例：r = 20なら、平文を20字ごとの群に切る（最後は不足可）。
2. 各群について、平文を **基準行（段差0）** に **縦方向で位置合わせ** する（上下に滑らせて合わせるイメージ）。
3. **段差**（段差1〜段差25のいずれか）を **任意に1つ** 選び、その行の文字列を **暗号文** として転記する。  
   - **重要**：段差は **毎回ランダムまたは事前規則で変化** させること。  
   - **理由**：段差を固定すると換字表が固定化し、単表式換字に退行して脆弱化。
4. 次の群に進み、同様に処理。  
   - 段差は **できるだけ不規則・平等** に使い分ける（偏りは攻撃面での手掛かりになるため）。

### 復号の仕組み

1. 送信側と同じ装着順でストリップを並べ、**周期 r** に従って暗号文を **r文字ごと** に群分け。
2. 各群についてストリップを上下に滑らせ、**段差0〜25** の候補行を確認する。
3. その群が **自然な文章** として読める行を採用する（通常、**周期が大きいほど** 候補は **ほぼ一意**）。  
   - それでも複数候補が出る場合、**暗号文が長いほど** 前後文脈で **絞り込み** やすい。
4. すべての群で可読行を選び、連結して平文を再現する。

### ストリップの並べ順（鍵語による一例：アルファベット順割当）

鍵語の各文字に **アルファベット順（A→Z）** で番号を割り当てる方式です。  
同じ文字が複数回出る場合は、**左から現れる順に若い番号**を与えます（先に出た方が小さい数）。

**手順**
1. 鍵語から空白・記号を除去し大文字化する（例：`"The strip cipher"` → `THESTRIPCIPHER`）。
2. 文字種ごとに **A→Z** の順で走査し、その文字が鍵語中に現れる位置へ **1, 2, 3, …** と番号を割り当てる。  
   - 同じ文字が複数箇所にある場合は、**左から出現する順**に若い番号を振る。
3. 得られた 1..N の番号列が、ストリップの**装着順**（左→右）になる。

**例（原典の割当結果をそのまま示す）**  
鍵語：`"The strip cipher"` → `THESTRIPCIPHER`  
装着順（アルファベット順割当・同字は左から若番）：
`17 5 2 15 17 12 8 10 1 9 11 6 3 13 19 7 4 16 20 14`

> ※上の例は **20本のストリップ** を想定して番号が **1〜20** まで割り当てられています。  
> キーフレーズ長と本数が一致しない場合は、運用上（例：日課表や補助キーで）本数に合わせて調整します。  
> この方法は**並べ方の一例**であり、他の割当法もあり得ます。

### 運用上のポイント

- **段差選択**：毎回ランダムまたは日課表（事前規則）で**変化**させる。固定は厳禁。  
- **更新**：ストリップの実物は**1〜数ヶ月ごと**に更新、**配列（日付キー）**は通常**毎日更新**。通信量が多い日はさらに細分化。  
- **復号の現実**：周期（使用ストリップ本数）が**大きいほど**、各群（例：20文字）の**自然文候補はほぼ一意**になりやすい。  
  - それでも複数候補が出る場合、**暗号文が長いほど**前後文脈で**絞り込み**が効く。

---

## ⚙️ 仕様（教育用簡易モデル）

- **アルファベット**：A–Z（26文字）
- **正規化**：大文字化／非アルファ削除を自動実行
- **ストリップ**：1本につき**26文字列×2回繰り返し**を縦書き相当で保持（52文字×縦表示）
- **段差（差分行）制御**
  - 暗号化・復号で**独立した段差管理**（`cipherRowGapEnc`/`cipherRowGapDec`）
  - 暗号化時は段差+1、復号時は段差-1の初期値で相互補完
  - リアルタイム段差調整により即座に結果反映
- **UI機能**
  - **タブ間同期**：暗号化↔復号間でデータ相互転送機能
  - **ドラッグ&ドロップ**：ストリップ配置の直感的な順序変更
  - **リアルタイム検証**：入力文字の範囲外文字警告表示
  - **動的レイアウト**：ストリップ表示に応じたコンテナ高調整

---

## 🧮 数学的補足

- **ストリップ1本の並び**は **26!** 通り。  
- **n本から r本を順序つきで選ぶ総数**は **nPr = n!/(n−r)!**。  
  - ここに **r! を重ねて掛けない**（順列は「選ぶ＋並べる」を含むため）。

---

## 📜 歴史メモ

- **系譜**：ジェファソン（ホイール暗号）やバズリー（シリンダー暗号）の**平面実装**と捉えられる。  
- **繰り返し印字の理由**：ストリップは環状でない前提のため、**26文字列を上下に繰り返す**ことで端で止まらず滑走できる（操作便宜）。

### 日本での活用
- 1941年12月、ウェーク島占領過程で**ストリップ型暗号器を入手**。日本でも簡便性に注目し、日本語向けの方式を試作。  
  - 五十音をそのまま使うと大型化するため、**7字ごとの群**（例：イロハニホヘト）に分割し、各群をランダム順にしたストリップを複数用意。  
  - **B4縦**ほどのセルロイド板にストリップを横挿し、**縦に読む**構成。**実用性は高くなかった**とされる。  
- 1944年8月、**海軍は乱数生成**のためにストリップ暗号器を活用。  
  - 25個の乱数を縦に並べた**乱片**を100本作成、20本を並べると**1行20数字＝4語**、25行で**計100語**分の乱数が得られる。  
  - 使用ストリップ番号の順序を共有すれば、受信側でも**同じ乱数**を再現可能。  
  - **呂暗号**や**天暗号**の乱数作成に利用した記録あり。

---

## 🎓 暗号学的考察（教育的視点）

- ストリップ暗号は**特殊な換字式**。  
- **鍵で一意に固定しない**（候補行＝25通りから選ぶ）という運用が特徴。  
- 復号は「**自然言語性**（可読性）」を手掛かりに候補行を選ぶ**判読作業**を要する。  
- **段差固定は危険**：換字表が固定し、**単表式換字**に退行して頻度解析に脆弱化。

---

## ❓ よくある質問（FAQ）

### Q. なぜストリップに同じ26文字列を繰り返すの？

A. 環状でない限り、端で止まると操作が煩雑になるためです。繰り返すことで滑らかに位置合わせできます。

### Q. 段差は本当にランダムに？

A. 少なくとも固定は避けるべきです。日課表（時間帯やメッセージ単位）などの規則で十分に変化させる運用が推奨です。

### Q. 候補行が複数出たら？

A. 周期を増やす、メッセージ長を伸ばす、前後文脈で照合する、といった現実的な手段で一意性を高められます。

---

## 📁 ディレクトリー構成

```
strip-cipherlab/
├── index.html          # メインHTMLファイル（5タブUI構成）
├── style.css           # スタイルシート（レスポンシブ・ドラッグ対応）
├── script.js           # JavaScriptメインロジック（状態管理・UI制御）
├── README.md           # プロジェクト説明書
├── .gitignore          # Git除外設定
├── .nojekyll           # GitHub Pages設定
└── data/               # データディレクトリ
```

### 主要ファイルの実装概要

- **index.html**：5つのタブ（ストリップ作成・設定・暗号化・復号・座学）で構成
- **style.css**：Flexboxレイアウト、ドラッグ&ドロップ視覚効果、レスポンシブ対応
- **script.js**：
  - 状態管理：`strips`配列、`frameOrder`、独立段差制御
  - UI制御：タブ切替、リアルタイム更新、動的高さ調整
  - 暗号処理：文字正規化、ストリップ位置計算、段差適用

---

## 📄 ライセンス

MIT License – 詳細は [LICENSE](LICENSE) を参照してください。

---

## 🛠 このツールについて

本ツールは、「生成AIで作るセキュリティツール100」プロジェクトの一環として開発されました。 
このプロジェクトでは、AIの支援を活用しながら、セキュリティに関連するさまざまなツールを100日間にわたり制作・公開していく取り組みを行っています。

プロジェクトの詳細や他のツールについては、以下のページをご覧ください。  

🔗 [https://akademeia.info/?page_id=42163](https://akademeia.info/?page_id=42163)
